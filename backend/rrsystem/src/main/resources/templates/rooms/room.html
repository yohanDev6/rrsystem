<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Login</title>

    <!--Google fonts-->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&display=swap" rel="stylesheet">

    <link rel="stylesheet" th:href="@{/css/default.css}" />
    <link rel="stylesheet" th:href="@{/css/room.css}"/>
</head>
<body>
	<header>
        <h1>Room Reservation System</h1>
        <nav>
            <a href="/">Home</a>
            <a href="/profile">Profile</a>
            <a href="/reservations">Reservations</a>
            <a href="/login" id="exit">Exit</a>
        </nav>
    </header>
    <main>
        <section id="roomSection">
            <h2>Room Details</h2>
            <div id="roomDetails">
                <p>Select a room to view its details</p>
            </div>
        </section>
        <section id="reservationSection">
            <h2>Set Data to Make the Reservation</h2>
            <form id="reservationForm">
                <div class="field">
                    <label for="startDateTime">Start Date and Time</label>
                    <input id="startDateTime" type="datetime-local" name="startDateTime" required />
                </div>
                <div class="field">
                    <label for="endDateTime">End Date and Time</label>
                    <input id="endDateTime" type="datetime-local" name="endDateTime" required />
                </div>
                <button type="submit" id="reservationButton">Make the Reservation</button>
            </form>
        </section>
    </main>
	<footer>
		<p>All rights reserved &copy</p>
		<p>Pedro Yohan Mendon√ßa da Silva <a href="mailto:yohan.dev6@gmail.com">yohan.dev6@gmail.com</a></p>
	</footer>
	<script>
		const path = window.location.pathname;
		const id = path.split('/').pop();

		fetch(`/rooms/${id}`, {
		    method: 'GET',
		    headers: {
		        'Authorization': `Bearer ${localStorage.getItem('jwtToken')}`,
		        'Content-Type': 'application/json'
		    }
		})
		.then(response => {
		    if (response.ok) {
		        return response.json();
		    } else {
		        throw new Error('Erro ao buscar a sala');
		    }
		})
		.then(data => {
		    displayRoom(data);
		})
		.catch(error => {
		    console.error('Erro ao carregar a sala:', error);
		    window.location.href = '/login';
		});

		function displayRoom(room) {
		    const roomDiv = document.getElementById('roomDetails');
		    roomDiv.innerHTML = `
		        <h3>${room.name}</h3>
		        <p>Capacity: ${room.capacity}</p>
		        <p id="availability">${room.availability ? 'Available now' : 'Unavailable now'}</p>
		    `;
			
			const availability = document.getElementById("availability");

	        if (availability.innerHTML.trim() === "Available now") {
	            availability.style.color = "green";
	        } else if (availability.innerHTML.trim() === "Unavailable now") {
	            availability.style.color = "red";
	        }
		}
	</script>
</body>
</html>